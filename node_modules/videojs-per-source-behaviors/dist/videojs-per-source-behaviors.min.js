/*! @name videojs-per-source-behaviors @version 2.1.0 @license Apache-2.0 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):e.videojsPerSourceBehaviors=t(e.videojs)}("undefined"!=typeof self?self:this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var t=e.getTech("Html5"),n=e.registerPlugin||e.plugin,r=["abort","emptied","loadstart","play"],i=["abort","emptied"],o=["ad-playback","ads-ready?","postroll?","preroll?"],u=function(e,t){return!!e.usingPlugin("ads")&&(function(e){return e.usingPlugin("ads")&&"function"==typeof e.ads.inAdBreak}(e)?e.ads.isInAdMode()&&"loadstart"!==t.type:(n=e.ads.state,o.indexOf(n)>-1));var n},s=function(){var n,o,s=this,a=[],d=!1,f=!0,c=function(t){return function(n,r){var i=this;if(!this.perSourceBehaviors.disabled()){var o=2===arguments.length,u=this.currentSrc(),s=[n],d=e.bind(o?this:n,arguments[arguments.length-1]),f=function(){var e=i.currentSrc()!==u;i.perSourceBehaviors.disabled()||((e||t)&&i.off.apply(i,s),e||d.apply(void 0,arguments))};return f.guid=d.guid,o||s.push(r),s.push(f),a.push(s),this.on.apply(this,s)}}};this.perSourceBehaviors={disable:e.bind(this,function(){return this.clearTimeout(o),o=null,d=!0}),disabled:function(){return d},enable:function(){return d=!1},enabled:function(){return!d},isSrcStable:function(){return f},VERSION:"2.1.0"},this.onPerSrc=c(),this.onePerSrc=c(!0),this.on("dispose",function(){a.length=0}),this.on(r,function(e){if(!(s.perSourceBehaviors.disabled()||o||u(s,e))){f&&i.indexOf(e.type)>-1&&(f=!1,s.trigger("sourceunstable"));var r=[],d=function(e){return r.push({time:Date.now(),event:e})};d(e),s.on(t.Events,d),o=s.setTimeout(function(){var e=s.currentSrc();f=!0,o=null,s.off(t.Events,d),e&&e!==n&&(a.forEach(function(e){return s.off.apply(s,e)}),a.length=0,s.trigger("sourcechanged",{interimEvents:r,from:n,to:e}),n=e)},1)}})};return s.VERSION="2.1.0",n("perSourceBehaviors",s),s});
